<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <link rel="stylesheet" href="../css/jquery.mobile-1.4.5.min.css">
    <link rel="stylesheet" href="../css/default_theme.min.css">
    <link rel="stylesheet" href="../css/jquery.mobile.icons.min.css">
    <link rel="stylesheet" href="../css/style.css">
    <script src="../js/jquery-1.11.2.min.js"></script>
    <script src="../js/jquery.mobile-1.4.5.min.js"></script>
    <script src="../js/standard.js"></script>
</head>
<body>
    <div class="txtwrapper">
        <!-- lista aziende -->
        <div data-role="page" id="page_lista_aziende">
            <!-- pannello laterale -->
            <div data-role="panel" id="myPanel" data-display="overlay" data-position="right">
                <div class="ui-btn-right">
                    <a href="#myPanel" class="ui-btn ui-shadow ui-btn-inline ui-btn-icon-left ui-icon-grid"
                        data-role="button" data-icon="grid">&nbsp;</a>
                </div>
                <br>
                <br>
                <br>
                <a href="../index.html" class="btn_search ui-btn sideOption ui-btn-inline ui-icon-home ui-btn-icon-left"
                    data-role="button" data-icon="home" data-ajax="false">Home</a> <a href="ricerca.html"
                        class="btn_search ui-btn sideOption ui-btn-inline ui-icon-search ui-btn-icon-left"
                        data-role="button" data-icon="search" data-ajax="false">Cerca</a> <a href='#settings'
                            data-icon='gear' data-rel='popup' data-position-to='window' data-transition='pop'
                            class='btn_search ui-btn sideOption ui-btn-inline ui-icon-gear ui-btn-icon-left'>
                            Impostazioni</a>
                <!-- setting -->
                <div id="settings" data-role="popup">
                    <div data-role="header">
                        <a href="#" data-iconpos="notext" data-mini="true" class="ui-btn ui-corner-all sideOption ui-btn-inline ui-btn-b ui-icon-delete ui-mini ui-btn-icon-notext ui-btn-right"
                            data-rel="back" data-icon="delete">&nbsp;</a>
                        <h1>
                            Impostazioni</h1>
                    </div>
                    <div data-role="content">
                        <ul data-role="listview" style="margin: 0 !important">
                            <li><a href="#" class="small">Testo piccolo</a></li>
                            <li><a href="#" class="med">Testo medio</a></li>
                            <li><a href="#" class="large">Testo grande</a></li>
                        </ul>
                    </div>
                </div>
                <a href='#page_info' data-icon='info' data-rel='popup' data-position-to='window'
                    data-transition='pop' class='btn_search ui-btn sideOption ui-btn-inline ui-icon-info ui-btn-icon-left'>
                    Info</a>
                <!-- info -->
                <form data-role="popup" method="get" id="page_info">
                <div data-role="header">
                    <a href="#" data-iconpos="notext" data-mini="true" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b ui-icon-delete ui-mini ui-btn-icon-notext ui-btn-right"
                        data-rel="back" data-icon="delete">&nbsp;</a>
                    <h1>
                        Info</h1>
                </div>
                Testo di prova per la richiesta di documenti
                <input type="submit" value="Invia Richiesta" />
                </form>
                <!-- registrazione azienda -->
                <form data-role="popup" method="get" id="page_registrazione">
                <div data-role="header">
                    <a href="#" data-iconpos="notext" data-mini="true" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b ui-icon-delete ui-mini ui-btn-icon-notext ui-btn-right"
                        data-rel="back" data-icon="delete">&nbsp;</a>
                    <h1>
                        Registrazione</h1>
                </div>
                Testo di prova per la registrazione della azienda
                <input type="submit" value="Registra azienda" />
                </form>
            </div>
            <!-- fine pannello laterale -->
            <div data-role="header" data-position="fixed">
                <a href="#" data-rel="back" data-icon="back" data-position="inline" class="ui-btn-left">
                    &nbsp;</a> <a href="../index.html" data-role="none" class="link_index" data-ajax="false">
                        <img src="../img/logo_trovoperte.png" class="logo_trovo"></a>
                <div class="ui-btn-right">
                    <a href="#myPanel" class="ui-btn ui-shadow ui-btn-inline ui-btn-icon-left ui-icon-grid"
                        data-role="button" data-icon="grid">&nbsp;</a>
                </div>
            </div>
            <div role="main" id="" class="ui-content">
                <div data-role="content">
                    <ul data-role="listview" id="lista_aziende" data-divider-theme="a" data-inset="true">
                        <li data-role="list-divider" data-theme="b" role="heading">Seleziona tipo attivit√†</li>
                    </ul>
                </div>
            </div>
            <div data-role="footer" data-position="fixed">
                <a href='#page_info' data-icon='info' data-rel='popup' data-position-to='window'
                    data-transition='pop' class='ui-btn ui-shadow ui-btn-inline ui-icon-info ui-btn-icon-left'>
                    Richiedi info</a> <a href='#page_registrazione' data-icon='info' data-rel='popup'
                        data-position-to='window' data-transition='pop' class='ui-btn ui-shadow ui-btn-inline ui-icon-info ui-btn-icon-left'>
                        Registra azienda</a> <a href='lista_circuiti.html' id="btnCircuitiConvenzionati"
                            data-ajax="false">Convenzioni</a>
            </div>
        </div>
        <!--page-->
    </div>
    <script>

        $("#page_lista_aziende").on("pageshow", function (event) {

            var id_categoria = getParameterByName("id_categoria");
            var id_circuito = getParameterByName("id_circuito");
            var elenco_recenti = getParameterByName("elenco_recenti")

           

            if (id_categoria && id_categoria != "") {

                $.getJSON("http://www.mvitalia.com/dimostrativi/patrizia/alex/trovo_x_te/admin/get_json_data.asp?id_categoria=" + id_categoria, function (info_categ) {

                    //string to put HTML in
                    //set up string for adding <li/>
                    var li = "";
                    //container for $li to be added
                    $.each(info_categ, function (i, name) {
                        //add the <li> to "li" variable
                        //note the use of += in the variable
                        //meaning I'm adding to the existing data. not replacing it.
                        //store index value in array as id of the <a> tag
                        if ((name.id_categoria == id_categoria)) {
                            li += '<li><a href="dettaglio.html?id_azienda=' + name.id + '" id="' + name.id + '" class="azienda-go" data-ajax="false">';
                            if (name.foto_principale != "") {
                                li += '<img src="http://www.trovoperte.com/public/upload_gallery/immagini/' + name.foto_principale + '" class="ui-li-thumb"/>';
                            }
                            else {
                                li += "<img src='http://www.trovoperte.com/public/upload_gallery/immagini/ico-vuoto.jpg' class='ui-li-thumb'/>";
                            }
                            li += '<h3 class="ui-li-heading">' + name.ragione_sociale + '</h3><p class="ui-li-desc">' + name.paese + '</p></a></li>';

                        }
                    });
                    //append list to ul
                    $("#lista_aziende").append(li).promise().done(function () {

                        //refresh list to enhance its styling.
                        $(this).listview("refresh");
                    });
                });
            }
            if (id_circuito && id_circuito != "") {

                $.getJSON("http://www.mvitalia.com/dimostrativi/patrizia/alex/trovo_x_te/admin/get_json_data.asp?id_circuito=" + id_circuito, function (info_circuito) {
                    //string to put HTML in
                    //set up string for adding <li/>
                    var li = "";
                    //container for $li to be added
                    $.each(info_circuito, function (i, name) {
                        //add the <li> to "li" variable
                        //note the use of += in the variable
                        //meaning I'm adding to the existing data. not replacing it.
                        //store index value in array as id of the <a> tag
                        if ((name.id_circuito == id_circuito)) {
                            li += '<li><a href="dettaglio.html?id_azienda=' + name.id + '" id="' + name.id + '" class="azienda-go" data-ajax="false">';
                            if (name.foto_principale != "") {
                                li += '<img src="http://www.trovoperte.com/public/upload_gallery/immagini/' + name.foto_principale + '" class="ui-li-thumb"/>';
                            }
                            else {
                                li += "<img src='http://www.trovoperte.com/public/upload_gallery/immagini/ico-vuoto.jpg' class='ui-li-thumb'/>";
                            }
                            li += '<h3 class="ui-li-heading">' + name.ragione_sociale + '</h3><p class="ui-li-desc">' + name.paese + '</p></a></li>';

                        }
                    });
                    //append list to ul
                    $("#lista_aziende").append(li).promise().done(function () {

                        //refresh list to enhance its styling.
                        $(this).listview("refresh");
                    });
                });
            }
            if (elenco_recenti && elenco_recenti != "") {

                $.getJSON("http://www.mvitalia.com/dimostrativi/patrizia/alex/trovo_x_te/admin/get_json_data.asp?elenco_recenti=si", function (ultime_aziende) {
                    //string to put HTML in
                    //set up string for adding <li/>
                    var li = "";
                    //container for $li to be added
                    $.each(ultime_aziende, function (i, name) {
                      
                        //add the <li> to "li" variable
                        //note the use of += in the variable
                        //meaning I'm adding to the existing data. not replacing it.
                        //store index value in array as id of the <a> tag

                        li += '<li><a href="dettaglio.html?id_azienda=' + name.id + '" id="' + name.id + '" class="azienda-go" data-ajax="false">';

                        if (name.foto_principale != "") {
                            li += '<img src="http://www.trovoperte.com/public/upload_gallery/immagini/' + name.foto_principale + '" class="ui-li-thumb"/>';
                        }
                        else {
                            li += "<img src='http://www.trovoperte.com/public/upload_gallery/immagini/ico-vuoto.jpg' class='ui-li-thumb'/>";
                        }
                        li += '<h3 class="ui-li-heading">' + name.ragione_sociale + '</h3><p class="ui-li-desc">' + name.paese + '</p></a></li>';


                    });
                    //append list to ul
                    $("#lista_aziende").append(li).promise().done(function () {

                        //refresh list to enhance its styling.
                        $(this).listview("refresh");
                    });
                });
            }

        });             
            
        



    </script>
</body>
</html>
